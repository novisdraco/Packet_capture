
rule Advanced_Malware_Detection {
    meta:
        description = "Advanced malware detection patterns"
        author = "Security Team"
        date = "2024-01-01"
        severity = "Critical"
        
    strings:
        $api1 = "CreateRemoteThread"
        $api2 = "VirtualAllocEx"
        $api3 = "WriteProcessMemory"
        $api4 = "SetWindowsHookEx"
        $api5 = "GetProcAddress"
        
        $packer1 = "UPX"
        $packer2 = "ASPack"
        $packer3 = "PESpin"
        
        $crypto1 = { 6A 40 68 00 30 00 00 }  // VirtualAlloc pattern
        $crypto2 = { 55 8B EC 83 EC ?? 56 57 }  // Function prologue
        
    condition:
        (3 of ($api*)) or
        any of ($packer*) or
        any of ($crypto*)
}
